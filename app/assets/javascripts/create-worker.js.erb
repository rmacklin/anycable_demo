window.appWorker = (typeof SharedWorker === 'undefined') ?
  new Worker('<%= asset_path('worker.js') %>') :
  new SharedWorker('<%= asset_path('shared-worker.js') %>').port;

appWorker.onmessage = function(e) {
  switch (e.data[0]) {
    case 'successMessage':
      App.utils.successMessage(e.data[1]);
      break;
    case 'errorMessage':
      App.utils.errorMessage(e.data[1]);
      break;
    case 'simpleMessage':
      App.utils.simpleMessage(e.data[1]);
      break;
    case 'BasketsChannel.handle_message':
      handleBasketsChannelMessage(e.data[1], e.data[2]);
      break;
    case 'ProductsChannel.handle_message':
      handleProductsChannelMessage(e.data[1], e.data[2]);
      break;
    default:
      console.log(`Unknown case ${e.data[0]}`);
  }
};
